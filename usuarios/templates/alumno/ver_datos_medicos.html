{% extends "baseAlumno.html" %}
{% block contenido %}

	<script type="text/javascript">
		function showContent(div_escondido, visibilidad) {
	        //element = document.getElementById("div_escondido"); 	        
	        element = document.getElementById(div_escondido); 
	        //seleccion = document.getElementById("visibilidad");
	        seleccion = document.getElementById(visibilidad);
	        valor = seleccion.options[seleccion.selectedIndex].value;
	        if (valor == '2') {
	            element.style.display='block';
	        }
	        else {
	            element.style.display='none';
	        }
		}

		window.onload = function(){
			showContent('esconder_medicamentos', 'visibilidad_medicamento');
			showContent('esconder_operaciones', 'visibilidad_operaciones');
			showContent('esconder_osocial', 'visibilidad_osocial');
		}
	</script>
	<script>
		window.jQuery || document.write('<script src="{% static "js/jquery.min.js" type="text/javascript"}""><\/script>')
	
	    $(document).ready(function(){ 
	      $('#ver-info-datosMedicos').on('click',function(){
	       $('#info-datosMedicos').slideToggle('slow');
	      });
	    });
	
	    $(document).ready(function(){ 
	      $('#ver-info-fichaMedica').on('click',function(){
	       $('#info-fichaMedica').slideToggle('slow');
	      });
	    });
	
	    $(document).ready(function(){ 
	      $('#ver-info-infoMedica').on('click',function(){
	       $('#info-infoMedica').slideToggle('slow');
	      });
	    });
	
	    $(document).ready(function(){ 
	      $('#eliminar').on('click',function(){
	       $('#eliminar-msj').slideToggle('slow');
	      });
	    });

	</script>
	<div class="panel-info">
		
		<ul class="nav nav-tabs" role="tablist">
			<li class="active" ><a href="#ficha_medica" data-toggle="tab" >Ficha Médica</a></li>
			<li><a href="#informacion_medica" data-toggle="tab" >Información Médica</a></li>
		</ul>
		<div class="tab-content">
		<!-- ################ PANEL FICHA MEDICA ####################################-->
			
			<div role="tabpanel" class="tab-pane fade in active" id="ficha_medica" >
				<div class="page-header panel-default ">
					<h3><i> Ficha Médica </i>
					<ul class="nav navbar-right">
					<a id="ver-info-datosMedicos" title="Info" type="text" type="button" class="btn">
					<span class = "glyphicon glyphicon-info-sign"> </span></a> 
				</ul></h3>
				</div>
				
				<div id="info-datosMedicos" class="navbar-text" style="display: none;">
					<i><p>En este espacio usted podra subir su ficha médica.</p>
					<p>La ficha médica es un documento que será suministrado por los profesores de los distintos deportes, y usted como alumno deberá rellenar junto con su médico de confianza.</p>
					<p>Una vez rellenada, podra subir una copia de la misma para que sea visible por los profesores de manera digital.</p>
					<p>A continuación le mostraremos la lista de deportes en los cuales se encuentra inscripto, como así también el enlace para descargar la ficha médica y una nota del profesor.</p>
					<p>Usted está inscripto en los siguientes deportes:</p></i>
				</div>
				{% if deportes %}
				<table class="table table-striped">
					<thead>
						<tr id="cabecera-tabla">
							<th>Nombre</th>
							<th>Nota del Profesor</th>
							<th>Archivo</th>
							
						</tr>
					</thead>
				{% for d in deportes %}
					<tbody>
						<tr>
							<td>{{d.nombre}} </td>
							{% if d.ficha_medica %}
								<td>{{d.ficha_medica.descripcion}}</td>
								<td><a title="Descargar" type="text" href="{{d.ficha_medica.ficha_medica.url}}"> <span class = "glyphicon glyphicon-download-alt" >  </span> </a></td>

							{% else %}
								<td>El profesor de {{d.nombre}} no ha subido aun una ficha médica.</td>
								<td>-</td>
							{% endif %}
							
						</tr>
					</tbody>
				{% endfor %}
				</table>
				<form method="POST" enctype="multipart/form-data">{% csrf_token %}
					
					<ul class="nav navbar-right">
						<a  title="Info" type="text" id="ver-info-fichaMedica" type="button" class="btn">
						<span class = "glyphicon glyphicon-info-sign"> </span> </a> 
					</ul>
					<div id="info-fichaMedica" class="navbar-text" style="display: none;">
						<i><p>Para subir o modificar su ficha médica, seleccione la opción 'Seleccionar archivo' y posteriormente haga click en Guardar...</p>
						<p>Por favor, utilice el siguiente formato para el nombre de su archivo: DEPORTE_APELLIDO-NOMBRE_DNI</p></i>
					</div>
					{% for d in deportes %}
						{% if d.ficha_medica and d in alumno.lista_deporte %}
							{% if alumno.ficha_medica %}
							Usted ha subido la siguiente ficha médica (haga click en el nombre para descargar): 
							</br><a id="ficha_medica" href="{{alumno.ficha_medica.url}}">{{alumno.nombre_archivo}}</a>
							{% endif %}
						{% else %}
							{% if not d.ficha_medica %}
								
							{% else %}
								{{form.as_p}}
								<div class="navbar-btn">
									<button type='submit' class="btn btn-primary" value='Guardar' name="boton_guardar_form">Guardar</button>
								</div>	
							{% endif %} 
						{% endif %}
					{% endfor %}

					
					
				</form>
				{% endif %} 
			</div>
			<!-- ################ PANEL INFORMACION MEDICA ####################################-->
			<div role="tabpanel" class="tab-pane fade" id="informacion_medica" >
				<div class="page-header panel-default ">
					<h3><i> Información Médica </i>
					<ul class="nav navbar-right ">
					<a  title="Info" type="text" id="ver-info-infoMedica" type="button" class="btn  ">
					<span class = "glyphicon glyphicon-info-sign"> </span></a> 
				</ul></h3>
				</div>
				<div id="info-infoMedica" class="navbar-text" style="display: none;">
					<i>A continuacion, nos gustaria que nos suministres los siguientes datos.</p> 
					Al finalizar, seleccione la opcion "Guardar". Podra dirigirse a esta seccion cada vez que quiera realizar alguna modificacion.</i> 	
				</div>
				<form class="form-horizontal" role="form" method="POST" accept-charset="utf-8">{% csrf_token %}

					{% if messages %}
						{% for m in messages %}
							<div id="eliminar-msj"><li {% if m.tags %} class= "{{m.tags}}_message" {% endif %} ><a id="eliminar" class="btn btn-sm"><span class = "glyphicon glyphicon-remove"> </span></a> {{m}}</li></div>
						{% endfor %}		
										
					{% endif %}
					{% include "mensaje.html" %}

					<div class="well">
						<div class=" panel-default">
							
							<p><label>Grupo Sanguineo:</label></p>
							<p>{{form_dm.grupo_sanguineo}}</p></br>
							<p><label>Alergias:</label></p>
							<p>{{form_dm.alergias}}</p></br>
							<p>Toma Medicamentos:</p>
							<p>{{form_dm.toma_medicamentos}}</p></br>

							<div id="esconder_medicamentos" style="display: none;">
								<p><label>Qué Medicamentos:</label> </p>
								<p>{{form_dm.medicamentos_cuales}}</p></br>
							</div>
							<p><label>Tuvo operaciones:</label></p>
							<p>{{form_dm.tuvo_operaciones}}</p></br>
							
							<div id="esconder_operaciones" style="display: none;">
								<p><label>Tipo de Operación:</label> </p>
								<p>{{form_dm.operaciones_cuales}}</p></br>
							</div>

							<p><label>Tiene Obra Social:</label></p>
							<p>{{form_dm.tiene_osocial}}</p></br>

							<div id="esconder_osocial" style="display: none;">
								<p><label>Qué Obra Social:</label> </p>
								<p>{{form_dm.osocial_cual}}</p></br>
							</div>

						</div>
					</div>
					
					<button class="btn btn-primary" type="submit" value="Guardar" name="boton_guardar_form_dm" onclick="">Guardar</button>
					{{mensaje_error_dm}}
				</form>	
	   		</div>
		</div>
			
	</div>
	

{% endblock %}